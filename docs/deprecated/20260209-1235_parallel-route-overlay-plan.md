# 병렬 라우트 기반 상세 오버레이 설계서 (스크롤 복원 안정화)

## 배경
- 무한스크롤 리스트에서 상세 진입 후 뒤로가기 시 스크롤 위치가 간헐적으로 초기화됨.
- 상태 캐시/스크롤 복원으로는 레이스 컨디션이 남아 100% 보장이 어려움.
- 구조적 해결을 위해 리스트를 언마운트하지 않는 라우팅으로 전환한다.

## 목표
- 리스트를 항상 마운트 상태로 유지해 스크롤 위치가 자연스럽게 유지되도록 한다.
- 상세는 오버레이(모달 느낌)로 표시한다.
- SEO/공유 링크는 기존 `/posts/[id]` 페이지를 유지한다.

## 핵심 설계
- **Parallel Route + Intercepting Route** 사용
- 리스트 레이아웃은 그대로 유지, 상세는 별도 슬롯(@detail)로 렌더

### 라우팅 구조(안)
```
app/
  (feed)/
    layout.tsx
    page.tsx
    space/
      [render_model]/page.tsx
    @detail/
      (.)posts/
        [id]/page.tsx
```

### 동작 규칙
- 리스트에서 상세로 이동할 때: `/posts/[id]` → `@detail` 슬롯에서 오버레이로 렌더
- 외부 유입/새로고침: 기존 `/posts/[id]` 페이지를 풀페이지로 렌더

## SEO/공유 링크
- `/posts/[id]`는 그대로 유지 → 메타/OG 태그 정상
- 내부 이동 시만 오버레이 처리, 공유 링크는 풀페이지로 열림

## UI 설계
- 오버레이 래퍼: `fixed inset-0 z-50 overflow-auto`
- 배경: dim 없이 풀페이지처럼 표시
- 내부: 기존 `PostDetail` 재사용 + 오버레이 내부에 `Footer` 포함
- 오버레이 활성 시 `body` 스크롤 락 적용

## 작업 지시서

### 1) 라우트 구조 추가
- `app/(feed)/layout.tsx` 신설  
  - `children`(리스트)와 `detail` 슬롯을 함께 렌더
- `app/(feed)/@detail/(.)posts/[id]/page.tsx` 추가  
  - 오버레이 UI + `PostDetail` 렌더

### 2) 리스트 페이지 이동 구조 유지
- `ThreadCard`의 링크는 그대로 `/posts/[id]` 사용
- 별도 변경 불필요

### 3) 오버레이 레이아웃 구현
- 풀페이지 스타일(모달 박스 없음)
- `Footer`를 오버레이 내부에 렌더
- 모바일/데스크톱 동일한 페이지 레이아웃

### 4) 스크롤 락(선택)
- 오버레이 열림 시 `document.body.style.overflow = "hidden"`
- 닫힘 시 복원
- 필요하면 보류 가능

## 수용 기준(AC)
- 리스트에서 상세 → 뒤로가기 시 스크롤이 항상 유지됨
- 리스트 아이템 로딩 상태가 유지됨 (재요청 없음)
- 공유 링크(`/posts/[id]`)는 정상 풀페이지로 표시됨
- 모바일/데스크톱 모두 정상 동작

## QA 체크리스트
1. 리스트에서 2~3페이지 로딩 후 상세 진입
2. 뒤로가기 → 동일 위치 유지 확인
3. `/space/:model`에서도 동일 동작 확인
4. 직접 URL로 `/posts/[id]` 접속 시 풀페이지 확인
5. dim 배경 클릭 시 닫힘 확인
